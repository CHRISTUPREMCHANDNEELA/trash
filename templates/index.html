<!DOCTYPE html>
<html>
<head>
  <title>Saraswat Bank Portal</title>
  <meta charset="UTF-8" />
  <style>
    body {
      font-family: Arial;
      max-width: 500px;
      margin: 40px auto;
      padding: 20px;
      background: #f4f4f4;
    }
    input, button {
      padding: 10px;
      margin: 5px 0;
      width: 100%;
    }
    .section {
      margin-top: 30px;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px #ccc;
    }
  </style>
</head>
<body>
  <h2>🔐 Saraswat Bank Login</h2>
  <input type="text" id="username" placeholder="Username (e.g. user1)">
  <input type="password" id="password" placeholder="Password (e.g. pass123)">
  <button onclick="login()">Login</button>

  <div id="accountSection" class="section" style="display: none;">
    <h3>💳 Account Info</h3>
    <p><strong>Account No:</strong> <span id="accNum"></span></p>
    <p><strong>Balance:</strong> ₹<span id="balance"></span></p>

    <h4>💸 Transfer Funds</h4>
    <input type="text" id="toAccount" placeholder="To Account">
    <input type="number" id="amount" placeholder="Amount to Transfer">
    <button onclick="transfer()">Send</button>

    <h4>📜 Transaction History</h4>
    <ul id="transactions"></ul>
  </div>

  <script>
    let account = null;

    function login() {
      fetch("http://127.0.0.1:5000/api/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          username: document.getElementById("username").value,
          password: document.getElementById("password").value
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          account = data.account;
          document.getElementById("accountSection").style.display = "block";
          document.getElementById("accNum").innerText = account.accountNumber;
          document.getElementById("balance").innerText = account.balance.toFixed(2);
          renderTransactions(account.transactions);
        } else {
          alert("Login failed: " + data.message);
        }
      });
    }

    function transfer() {
      const amount = parseFloat(document.getElementById("amount").value);
      const toAccount = document.getElementById("toAccount").value;

      fetch("http://127.0.0.1:5000/api/transfer", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ toAccount, amount })
      })
      .then(res => res.json())
      .then(data => {
        if (data.success) {
          account = data.account;
          document.getElementById("balance").innerText = account.balance.toFixed(2);
          renderTransactions(account.transactions);
          alert("Transfer successful!");
        } else {
          alert("Transfer failed: " + data.message);
        }
      });
    }

    function renderTransactions(txns) {
      const list = document.getElementById("transactions");
      list.innerHTML = "";
      txns.slice().reverse().forEach(txn => {
        const li = document.createElement("li");
        li.innerText = `${txn.date}: ${txn.type} ₹${txn.amount}`;
        list.appendChild(li);
      });
    }
  </script>
</body>
</html>
